<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A QR driven advent calender">
    <meta name="author" content="Rich Bradish">
<style>
	.imageClip{
    width:100%;
    height: auto;
    overflow:hidden;
}
</style>
   <title>Advent Calender</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
  </head>
<body onLoad=loadHandler()>
<script type = 'text/javascript'>
var success = "You found a clue:<br>";
var unknown = "I don't have a clue!";
var broken = "No, no, no, no, NO! Hit Rich. It's OK, I said to."
var confused = "Try entering a four letter / number code - should be all caps.";
var clues = new Array();
var keys = new Array();

weak = /\?code=/;
matcher = /\?code=([A-Z0-9]{4})$/;
alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!,.;:-()@ /<>'=_&?{}…*";

keys[0]="JGOE"
keys[1]="HKLR"
keys[2]="JHTD"
keys[3]="IRDJ"
keys[4]="IF3H"
keys[5]="IO5G"
keys[6]="ORFG"
keys[7]="KI6F"
keys[8]="94FJ"
keys[9]="O9WG"
keys[10]="U5RG"
keys[11]="8RGI"
keys[12]="U652"
keys[13]="783F"
keys[14]="5YHF"
keys[15]="4YBR"
keys[16]="9FFG"
keys[17]="8955"
keys[18]="G764"
keys[19]="0UOW"
keys[20]="KC2A"
keys[21]="63XK"
keys[22]="DBN3"
keys[23]="ZBU3"
keys[24]="S1T5"

clues[0] = "w9_=;DRE8pjkxIOT3O3Rsy@ZNTCMOu.S4BOTXYwVNu3F2K7WNJC1RZVs3KOwpu7VLpGL3Z4WsvDH1O0IqM3SPRSlLU1tOOZIyJDi!Aq@-daVjT<FaS?b<c'0…{d3&Qdt5OS1F17TCYVE1O2KBE";
clues[1] = "u.>g,HOR6thxvML71SZ5qCsyvYVxvXZ!vATIHVWHwSCF1OLJny49JtDY1410qzAUYS7VoQZ6NVPyJYXGMSWVwNAv9Ena;h{9hX@SLWOY<bep&fNp?bNG3SP;D547A3SRYSYXzI";
clues[2] = "w0…';EWD8qqjxJTS3P8Qsz'YNUHLOv)R4CTSXZBUNvTr2S8ZxJ)FUP,WBnHV1JCvQ1.S2qIsMY2YNoZRXN5HqJ8PyM2ONwWsn9Nf';q/1h7!KIkceJ5.X xS? @ y32H6D;VYA,KJY2QPzR";
clues[3] = "v :}.OGJ7AbpwTDY2ZRWrJ85M5rRNF2X3MDYW0l1MFDU5R22w0HUTZQPwTX1ZVQ3wRFLW,Q31Jjx19FsAYW3X0myxUUR4VkPW6JUMyFXUGIRTVsMxv5Dka0g_9dW-S);h}'TT!F(b:-fKGYRM;z417w2PRURVXvH";
clues[4] = "v8i?.C6H7oBnwH3W2N(Urxb3MSQPNt&V3t-LMIQHVt752W3vKT31AlQZZHLzPY<W1oRwLW!3Mm9VWL;LpH(TxK!SMu6wm7Wj>,z=Zf-:J@x{}Htk{?…c/?;?x1!L5B>ZXy/OIW!UOx1";
clues[5] = "v(k&.L8G7xEmwQ5V2W@TrGd2M2SONC{U3C>ZZ9!MTSSZWC:KM4S5W9<uM.9Yw3 KVCMsAuSYZQNyP8'V1xTvL6.2Mv!UWU-KpQ@SxT.RMD8vm-Yi>/B'Zo);Jc:!gis =iz,I&z!x0.K5K=YXH>NI6.TOG3";
clues[6] = "B (&@OIG.AgmCTFV8ZTTxJ02S5tOTF4U9MFV30nXSFFR!R4YC3TY8Jlu79HpGYYZ40ovDUWO0VmM36LRSyHU1GKOZVuJDv7Aqa,da9fT<S&k8!JRZ3@;?7_!dG1OS;B177yYVRWO2XxE";
clues[7] = "x!l_:F9F9rHlyK6U4Q StAe1OVTNPw}T5D6UY1NWOw'TWM=NWM'tVI=JCoTX2KOxR2=U3rUuNZ;1Op,TYO(JrK RzN;QOx9uo0Zh=:C>2i@.L?(}f&gUUMgM8_-jz4;J7E_XZB'MKZ;SQA4";
clues[8] = "Va(}h1IJbMipW6FY?,TWRV05.(tR;R4X{RMJ}8t2 ,LQ?:4x!/F9bRMJ(/xpW<WLRVM3?@XsXSI1(=Jq:)TP 8mL>-uO(:Jy,Sj!3F -FpWj<fG'xcY&kp,cxpR?j<u5(82F{<UC&!F1((LB7";
clues[9] = "Bfc&@6ZG.RrkuWYG4?5U2RO!0.0uW;K53{RG4>:o6.KZS_;OP 1u!(-NC0(Y7.:yuW:XQRON8?,YxXLJ6()Kv:!UU 1nQ>9vT(8KD,Lk-3y//FiXo<}Heiz6&Ma@Qy?2?xlv0(13K{:VH&4G6(0MG7";
clues[10] = "Hb{&=2UG@NmbASTG0'ZU8NJ:I86TP57U.M!u(55ZI'YO.S!UI>6188FZ9@FM:>YO8!FH:'QyAS0XWNJN;'7YDTGJ,..KB!6U1-VnW@4vZ.3KJ8Gk<Yt/&BdXu)=Hh}>?gA>}Wgh2V;cv-.V3Q=0VN>YG,.5MM3";
clues[11] = "U ){gOJIaAbeNFII>!OW/Ay(V!NQ/2u5,MGX<0oZ,FZP,FVM=WKK&FSI&TNANFYZ0AyP&!V1QGvL=Z2MOXUW;3Kp06Sx.ZRMWUvmdLi>io'ZH5;Jsg'3qfaP9hah0>&x{ZK54,YX10NI=ZTOZP";
clues[12] = "Hckq=382@OzyAT720=.-8OWsYT--9-S-:=S79>S6U8,P9=,6,XKP.>7KM.'/0'NQJ9<0-0L89 !.YM7-7U0060T5JJaVwofyg>E:?7y}pC6q6Ekt0;8dWU_0Y?1<./X 26<08,WZ";
clues[13] = "Tei_f56F…QxdMV5F<&!T QU?!33U/_KW!V:F(--LU8Q2//6J'.>QU:(R!V<T.,<M!=UlU_ HPZ0Y_>/oVW6W:{7m.<(L),JH/ RK:@7u0WG71Jl,Dt f j4Fv>=…ylC igy&h_R1:,=B&_)y=:3W:/9x5";
clues[14] = "R&@_dVKF{HceKMJF )PT)Hz?9MOF_3vL<3HYSYK19,1Z<3Zt5)vM@!LxKMZW7HzM')WXNNwI<73JL5VT!0Lm7.Tu07SJT2wjaSj fv=WE,:Gs'./ttkU9p=!tp u_7L21@ZUX(OF<7ULWW";
clues[15] = "Q&.gcVER?H?rJMDR@)J6(HtQRYOUR5SV4)pR7 F5>@SV<MBS/.BUVEp0/1kJ!)U7<HqG7-J.8FH6)5MVK1P4S4J38NEGH_vtm…}d/yO=5s?Yye<qCnfukp'TS JV_UV0@RTY4-J50Qz";
clues[16] = "V8(&hCIGboahOtHG'YNU<ox=>tMK_JAG'TXo&tYUWZXyOtXX!oxN?YUYRuuJ_N1KPLTU:QJn!TRv;NQKXIukezh/jc>XIS.H.QURw0@…w&…fp!Pv}NJ35ZXV2XMG_NSM1D";
clues[17] = "Ufktg685aRzGNW75>?.@/RW…/,S,8?>S<;0S&>S{<{WKV&<7Q1,'&'>NWX8<-}9L;>@!@.L7</T0- 9T!XIa2KnfEu<E/k6qju.vh!?uCu_m &T_-.&1?& X_-5<-<!W6";
clues[18] = "tdls!4945PAGmU84V_;)TPXgu; @KU?8B7/)YO>8u=67J)07u{;>NU04I;T)Z;0/u, /u7T:U ,RZ:)8yMT<X9OVN_=@YPUSJ';=KN,)U.(8n9 -v,;:KV9SkcZF/hCpXG@fH8ByV7h7.wAxG0C6v?;833_<VZ'!G';(MY4";
clues[19] = "W>_liRRWcDkAPIQW=;W!>DG?',C9',SK-,SW{I11067OPI7;,DG4{;4:SJDZ&301Q13!-6SD,91L:3Z1YXDAfOqfkra;J8<Xy6R/D8',rj82r77L…3S@6:7,3.VW&3232S";
clues[20] = "x5h/:z5A9lx&qq4AZV0OXlT6YTPMYT6oQT6A4q'IXGTgyU@Ctu9T4R jzr5RSX6hQQ-GVGICYOQFSN6pNrF2Eek7h @aX03CWJg:c@FB}-uEcEQVSG'w5U(t3J2RSP8sI";
clues[21] = "S…d…eZ1K}LtgLQZK/<6Y@LP-  LW  2y66@O@<)20/PqT/:MOU54=)-tUR12;'2r,(,Q(7EM :MP;;2z9RB,ZEg(Co:k@eYaJoq<x)j{xo;&…9M6;7 G_/.D'0X2;-4C4";
clues[22] = "";
clues[23] = "M4ar}yX3'kqAFpW3:U3(.kMfNM9'4p@( p-7(ZI: D2UFp. 2kM0@U0/IqJ6(J-7GH9(6MYJ2P7R5J67OEJG&vwla}g zO?4g<t&kMjA3}<:1NbR/JY=VV.)ST23(J89Rz";
clues[24] = "F{…t>XW5(JpDyOV58 2@6JLgS-9{G{1<1@.(S@zS…5Z56FLKG@!7BS1',-,NHPW<1<XLY:8!45A77.I01,XTVPxaMCcfpm!E6cUr(vfq6-;l=D5m2&I_15-1.@9X!8T<1;ZWQ"

function loadHandler(){
	if(weak.test(location.href)){
		if(matcher.test(location.href)){
			var match = matcher.exec(location.href)[1]
			checkCode(match);
		}
		else{
			showAnswer(confused);
		}
	}
}
function checkCode(match){
	found = false;
	for(k=0;k<clues.length;k++){
		if("@CLUE"==decoder(clues[k].substr(0,5),match)){
			hideForm()
			//JSON and the arg[0]
			try{
				var obj = eval(decoder(clues[k],match).substr(5))
				HTMLanswer = ""+
				"<h3>"+obj.caption+"</h3>"
				"<img class = 'img-responsive imgClip' src='"+obj.src+"'>"
				showAnswer(HTMLanswer)
			}
			catch(e){
				showAnswer(broken)
			}
			found = true;
			break;
		}
	}
	if(!found){
		showAnswer(unknown)
	}
}
function hideForm(){
	document.getElementById("form").style.visibility = "hidden"
}

function showAnswer(text){
	document.getElementById("answer").innerHTML = text;
	document.getElementById("answer").style.visibility = "visible"
}

function printAll(){
	document.write("<table>");
	for(i=0;i<keys.length;i++){
		document.write("<tr><td><img src = 'http://qrcode.kaywa.com/img.php?s=2&d=http%3A%2F%2Fbradi.sh%2Fcode.html%3Fcode%3D"+keys[i]+"'></td><td><b>"+keys[i]+"</b><br></td></tr>");
	}
	document.write("</table>");
}

function encoder(text,key){
	return coder(text,key,1)
}
function decoder(text,key){
	return coder(text,key,-1)
}

function coder(text,key,direction){
	out = ""
	//chomp through the text, through the key, performing a modulus rotation through the 'alphabet'
	for(j=0;j<text.length;j++){
		if(alphabet.indexOf(text.substring(j,j+1))!=-1&&alphabet.indexOf(key.substring((j%key.length),(j%key.length)+1))!=-1){
			//encode the jth letter with the j mod key.length part of the key, then spit it back out
			out = out + alphabet.substr(
					(
						alphabet.indexOf(
							text.substring(j,j+1)
						)
						+alphabet.indexOf(
							key.substring(
								(j%key.length),(j%key.length)+1
							)
						)*direction
						+
						alphabet.length
					)%alphabet.length,
					1)
		}
		else{
			return "";
		}
	}
	return out
}
document.write("<scr" + "ipt type='text/plain'>clues[0] = \""+encoder("@CLUE{day:1, caption:'Even if you&apos;re obsessed with tea', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbWmN3M2JFVWUyRkU/view?usp=sharing'}",keys[0])+"\"");
document.write("<br>clues[1] = \""+encoder("@CLUE{day:2, caption:'.. ok, not <i>all</i> tea', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbemdhOWY4T1c4UWc/view?usp=sharing'}",keys[1])+"\"");
document.write("<br>clues[2] = \""+encoder("@CLUE{day:3, caption:'Even if you&apos;re a slow cyclist', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbbW51clJoM0pSMzQ/view?usp=sharing'}",keys[2])+"\"");
document.write("<br>clues[3] = \""+encoder("@CLUE{day:4, caption:'Even if you&apos;re always selling current accounts', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbOE5MUkltcHYxM2c/view?usp=sharing'}",keys[3])+"\"");
document.write("<br>clues[4] = \""+encoder("@CLUE{day:5, caption:'Even if you need an extra coat', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbN1VVcW9UWC1MWlU/view?usp=sharing'}",keys[4])+"\"");
document.write("<br>clues[5] = \""+encoder("@CLUE{day:6, caption:'Even if you struggle to keep your eyes open ;)', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbTkE4ZTNQZ1FaM1E/view?usp=sharing'}",keys[5])+"\"");
document.write("<br>clues[6] = \""+encoder("@CLUE{day:7, caption:'Even if you&apos;re always lost', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbV0ttelllNHNpUEU/view?usp=sharing'}",keys[6])+"\"");
document.write("<br>clues[7] = \""+encoder("@CLUE{day:8, caption:'Even if you&apos;re sometimes late', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbTlY1SGpkeGhxRk0/view?usp=sharing'}",keys[7])+"\"");
document.write("<br>clues[8] = \""+encoder("@CLUE{day:9, caption:'Even if you have slightly crazy hair', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbOUEtRHRGYURmSGs/view?usp=sharing'}",keys[8])+"\"");
document.write("<br>clues[9] = \""+encoder("@CLUE{day:10, caption:'Even if you&apos;re terrible with busses', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbVF9zM0JMcVFvNUU/view?usp=sharing'}",keys[9])+"\"");
document.write("<br>clues[10] = \""+encoder("@CLUE{day:11, caption:'I don&apos;t want this to sound too gushing but…', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbSzFVR2FXcHVvbjQ/view?usp=sharing'}",keys[10])+"\"");
document.write("<br>clues[11] = \""+encoder("@CLUE{day:12, caption:'I think we&apos;re the perfect match', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbQURuOTZhbVZ5cFU/view?usp=sharing'}",keys[11])+"\"");
document.write("<br>clues[12] = \""+encoder("@CLUE{day:13, caption:'We look out for each other', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbZC13bUl5LXpidHc/view?usp=sharing'}",keys[12])+"\"");
document.write("<br>clues[13] = \""+encoder("@CLUE{day:14, caption:'We&apos;re making a wonderful home together', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbaUpwZXJ6OHE2VGs/view?usp=sharing'}",keys[13])+"\"");
document.write("<br>clues[14] = \""+encoder("@CLUE{day:15, caption:'We have great adventures at home', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbTzFPU19peWRFUWM/view?usp=sharing'}",keys[14])+"\"");
document.write("<br>clues[15] = \""+encoder("@CLUE{day:16, caption:'… and great adventures abroad', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbZ1h1LU55U09MWWc/view?usp=sharing'}",keys[15])+"\"");
document.write("<br>clues[16] = \""+encoder("@CLUE{day:17, caption:'So here&apos;s to us', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbelplTENYTVZ5MFk/view?usp=sharing'}",keys[16])+"\"");
document.write("<br>clues[17] = \""+encoder("@CLUE{day:18, caption:'And hats off to you', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbRHRiWFcxV1RvNms/view?usp=sharing'}",keys[17])+"\"");
document.write("<br>clues[18] = \""+encoder("@CLUE{day:19, caption:'I hope we&apos;re saddled with each other for a long time', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbb21paHdGV1Zad3c/view?usp=sharing'}",keys[18])+"\"");
document.write("<br>clues[19] = \""+encoder("@CLUE{day:20, caption:'For more great meals', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbUldyZnJpNUtfNms/view?usp=sharing'}",keys[19])+"\"");
document.write("<br>clues[20] = \""+encoder("@CLUE{day:21, caption:'For more great wine', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbcmhKOXQ0bTNYeXc/view?usp=sharing'}",keys[20])+"\"");
document.write("<br>clues[21] = \""+encoder("@CLUE{day:22, caption:'For more adventures', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbV0RYLXpRSXRqQzg/view?usp=sharing'}",keys[21])+"\"");
document.write("<br>clues[22] = \""+encoder("@CLUE{day:23, caption:'For more *ahem*', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbM2pMR1BOeUtMcVU/view?usp=sharing'}",keys[22])+"\"");
document.write("<br>clues[23] = \""+encoder("@CLUE{day:24, caption:'I love you very much', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbMU5yQlU4d3BmbmM/view?usp=sharing'}",keys[23])+"\"");
document.write("<br>clues[24] = \""+encoder("@CLUE{day:25, caption:'Happy Christmas, Megan!', src:'https://drive.google.com/file/d/0B_8OG3Rr6nHbSy1RRnpuMG9lNjA/view?usp=sharing'}",keys[24])+"\"");
document.write("</scr"+"ipt>");
/*document.write("<br>clues[24] = \""+encoder("@CLUEOn Christmas Day:",keys[24])+"\"");*/
//printAll();
</script>
	<div class="container">
      <div class="header">
        <h3 class="text-muted">Advent calendar</h3>
      </div>
		<div class="col-xs-6">
			<form action = 'code.html' method = 'get'>
				<div class="panel panel-info">
					<div class="panel-heading">
						<h3 class="panel-title">Today is...</h3>
            				</div>
            				
            				<div class="panel-body">
	           				<div class="col-xs-4">
	           					<div id = 'answer' style = 'visibility:hidden;'></div>
	           				</div>
	           				<div class="col-xs-4" id = "form">
	           				<p><input type = 'text' id = 'code' name = 'code' class="form-control"></p>
	           				<p><input type = 'submit' value = 'Check it!' class="btn btn-lg btn-default" onclick = 'checkCode(document.getElementById("code").value)'></p>
						</div>
					</div>
					</div>
				</div>
			</form>
		</div>
	</div>
  </body>
</html>
