<!DOCTYPE html>
<html lang="en">
  <head>
 <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A QR driven advent calender">
    <meta name="author" content="Rich Bradish">

   <title>Advent Calender</title>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="../../assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
<body onLoad=loadHandler()>
<script type = 'text/javascript'>
var success = "You found a clue:<br>";
var unknown = "I don't have a clue!";
var confused = "Try entering a four letter / number code - should be all caps.";
var clues = new Array();
var keys = new Array();

weak = /\?code=/;
matcher = /\?code=([A-Z0-9]{4})$/;
alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!,.;:-()@ ";

keys[0]="JGOE"
keys[1]="HKLR"
keys[2]="JHTD"
keys[3]="IRDJ"
keys[4]="IF3H"
keys[5]="IO5G"
keys[6]="ORFG"
keys[7]="KI6F"
keys[8]="94FJ"
keys[9]="O9WG"
keys[10]="U5RG"
keys[11]="8RGI"
keys[12]="U652"
keys[13]="783F"
keys[14]="5YHF"
keys[15]="4YBR"
keys[16]="9FFG"
keys[17]="8955"
keys[18]="G764"
keys[19]="0UOW"
keys[20]="KC2A"
keys[21]="63XK"
keys[22]="DBN3"
keys[23]="ZBU3"
keys[24]="S1T5"


clues[0] = "H9fe;a2D3NSDOO6W3FRE8F3JI0SGNSPI1A"
clues[1] = "F.cr,eYQ1RPQZON6UNKUH9K6MJ:VJOXSL2F"
clues[2] = "H0kd;b7C3OXC3O2UMGWD8G8II!XFNTUH1B"
clues[3] = "G :j.lQI2YHIN6X12YCMI-CXNQ7NKVPKM9x"
clues[4] = "G8th. -G2M7GNN81PE6H7E(MH97JMR4LZz"
clues[5] = "G(vg.i)F2V9F1WhZPN8G7N@LH)9IM16KZI"
clues[6] = "M (g@lSF8YJF7V1K2!MFRR4F3WE0STJSPVWA"
clues[7] = "I!wf:c@E4P0EOQ,YRH9F9H KJ,0HOU7J2C"
clues[8] = "7l(jsxSIh!JIb,S3-3IJm3TO8mJL.-GNfX"
clues[9] = "Mqng@C0F8-1F8.0ZV8ZG.8!LNr1ISaXK63"
clues[10] = "Smigey5F;,VFY-V2Y)!NT8R5T@WFd9TK76VXO"
clues[11] = "6 )irlTHgYKHg;KTgYFL8-FW.Q0M0VSJ,9A"
clues[12] = "SnvBez)1;.91;..@;09:;.45Uj4-Z5n6W0(3YcY"
clues[13] = "5ptfqB-Ef:7E,b Y!,-Y;76Fk7(K6q7H! 4Jd2"
clues[14] = "3g@fosUEd6LE071J9,1M42H44.MEn3JJ(ZLWY"
clues[15] = "2g.rnsOQc6FQb7Y!83O!!XERhXPW3hFT8!CVaS"
clues[16] = "78(gs SFhMJFgJ1KbYJKhMEJ94EU;E9K!JRH.Wz"
clues[17] = "6qvErC)4g-94,(!,g.9)g-488m4@.8n90.(6,fY"
clues[18] = "EowD!A@3Z;03T:@8Z!0(Z;57Gk5)L6o8I!)5KdZ"
clues[19] = "8cfwto2Vi2SVi(S0i3S-(TRWnT329dSY;7P1gO"
clues[20] = "I5sa:(:z4J6z4Y6N41WFST TJF2YJQ7z;G4EWD6RE"
clues[21] = "4kokpw!Je02Jee2XegS305,X921Kj2,P5l2M0:YOcW"
clues[22] = "B4eC8-12WIR2WXR-WZIbKJ56CENgCPS27FP7PCR x"
clues[23] = "X4lCj-82hI,!)U73)Aed4v"
clues[24] = "QikEcu74a8!.! 65!Zc5(U"




function loadHandler(){
	if(weak.test(location.href)){
		if(matcher.test(location.href)){
			var match = matcher.exec(location.href)[1]
			checkCode(match);
		}
		else{
			showAnswer(confused);
		}
	}
}
function checkCode(match){
	found = false;
	for(k=0;k<clues.length;k++){
		if("@CLUE"==decoder(clues[k].substr(0,5),match)){
			hideForm()
			showAnswer(decoder(clues[k],match).substr(5))
			found = true;
			break;
		}
	}
	if(!found){
		showAnswer(unknown)
	}
return false;
}
function hideForm(){
	document.getElementById("form").style.visibility = "hidden"
}

function showAnswer(text){
	document.getElementById("answer").innerHTML = text;
	document.getElementById("answer").style.visibility = "visible"
}

function printAll(){
	document.write("<table>");
	for(i=0;i<keys.length;i++){
		document.write("<tr><td><img src = 'http://qrcode.kaywa.com/img.php?s=2&d=http%3A%2F%2Fbradi.sh%2Fcode.html%3Fcode%3D"+keys[i]+"'></td><td><b>"+keys[i]+"</b><br></td></tr>");
	}
	document.write("</table>");
}

function encoder(text,key){
	return coder(text,key,1)
}
function decoder(text,key){
	return coder(text,key,-1)
}

function coder(text,key,direction){
	out = ""
	//chomp through the text, through the key, performing a modulus rotation through the 'alphabet'
	for(j=0;j<text.length;j++){
		if(alphabet.indexOf(text.substring(j,j+1))!=-1&&alphabet.indexOf(key.substring((j%key.length),(j%key.length)+1))!=-1){
			//encode the jth letter with the j mod key.length part of the key, then spit it back out
			out = out + alphabet.substr(
					(
						alphabet.indexOf(
							text.substring(j,j+1)
						)
						+alphabet.indexOf(
							key.substring(
								(j%key.length),(j%key.length)+1
							)
						)*direction
						+
						alphabet.length
					)%alphabet.length,
					1)
		}
		else{
			return "";
		}
	}
	return out
}
/*document.write("<br>clues[0] = \""+encoder("@CLUEOn the first day of December:",keys[0])+"\"");
document.write("<br>clues[1] = \""+encoder("@CLUEOn the second day of December:",keys[1])+"\"");
document.write("<br>clues[2] = \""+encoder("@CLUEOn the third day of December:",keys[2])+"\"");
document.write("<br>clues[3] = \""+encoder("@CLUEOn the fourth day of December:",keys[3])+"\"");
document.write("<br>clues[4] = \""+encoder("@CLUEOn the fifth day of December:",keys[4])+"\"");
document.write("<br>clues[5] = \""+encoder("@CLUEOn the sixth day of December:",keys[5])+"\"");
document.write("<br>clues[6] = \""+encoder("@CLUEOn the seventh day of December:",keys[6])+"\"");
document.write("<br>clues[7] = \""+encoder("@CLUEOn the eigth day of December:",keys[7])+"\"");
document.write("<br>clues[8] = \""+encoder("@CLUEOn the ninth day of December:",keys[8])+"\"");
document.write("<br>clues[9] = \""+encoder("@CLUEOn the tenth day of December:",keys[9])+"\"");
document.write("<br>clues[10] = \""+encoder("@CLUEOn the eleventh day of December:",keys[10])+"\"");
document.write("<br>clues[11] = \""+encoder("@CLUEOn the twelth day of December:",keys[11])+"\"");
document.write("<br>clues[12] = \""+encoder("@CLUEOn the thirteenth day of December:",keys[12])+"\"");
document.write("<br>clues[13] = \""+encoder("@CLUEOn the forteenth day of December:",keys[13])+"\"");
document.write("<br>clues[14] = \""+encoder("@CLUEOn the fiteenth day of December:",keys[14])+"\"");
document.write("<br>clues[15] = \""+encoder("@CLUEOn the sixteenth day of December:",keys[15])+"\"");
document.write("<br>clues[16] = \""+encoder("@CLUEOn the seventeeth day of December:",keys[16])+"\"");
document.write("<br>clues[17] = \""+encoder("@CLUEOn the eighteenth day of December:",keys[17])+"\"");
document.write("<br>clues[18] = \""+encoder("@CLUEOn the nineteenth day of December:",keys[18])+"\"");
document.write("<br>clues[19] = \""+encoder("@CLUEOn the twentieth day of December:",keys[19])+"\"");
document.write("<br>clues[20] = \""+encoder("@CLUEOn the twenty-first day of December:",keys[20])+"\"");
document.write("<br>clues[21] = \""+encoder("@CLUEOn the twenty-second day of December:",keys[21])+"\"");
document.write("<br>clues[22] = \""+encoder("@CLUEOn the twenty-third day of December:",keys[22])+"\"");
document.write("<br>clues[23] = \""+encoder("@CLUEOn Christmas Eve:",keys[23])+"\"");
document.write("<br>clues[24] = \""+encoder("@CLUEOn Christmas Day:",keys[24])+"\"");*/
//printAll();
</script>
    <div class="site-wrapper">
      <div class="site-wrapper-inner">
        <div class="cover-container">
          <div class="masthead clearfix">
            <div class="inner">
              <h3 class="masthead-brand">Advent Calendar</h3>
              <nav>
                <ul class="nav masthead-nav">
                  <li class="active"><a href="#">Home</a></li>
                  <li><a href="#">Features</a></li>
                  <li><a href="#">Contact</a></li>
                </ul>
              </nav>
            </div>
          </div>

          <div class="inner cover">
            <h1 class="cover-heading">What's today?</h1>
          </div>

          <div class="mastfoot">
            <div class="inner">
        	<form action = 'code.html' method = 'get'>
        		<div class="panel panel-info">
				<div class="panel-heading">
                      			<h3 class="panel-title">So...</h3>
            			</div>
	           		<div id = 'answer' style = 'visibility:hidden;' class="panel-body"></div>
	           		<input type = 'text' id = 'code' name = 'code' class="form-control"><br>
	           		<input type = 'submit' value = 'Check it!' class="btn btn-lg btn-default" onclick = 'checkCode(document.getElementById("code").value)'>
			</div>
		</form>
	    </div>
	  </div>
        </div>

        </div>

      </div>

    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  </body>
</html>
